# End-to-End Medical AI System for Pneumonia Detection
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/Motea99/Pneumonia-Diagnosis-System-Challenge/blob/main/MAI_End_To_End_Demo.ipynb)
Medical AI Pneumonia Diagnosis SystemEnd-to-End Deep Learning, Visual Language Model, and Retrieval PrototypeAlfaisalX: Cognitive Robotics & Autonomous Agents – Technical Challenge1. Project OverviewThis project presents a complete end-to-end Artificial Intelligence system for automated analysis of chest X-ray images.The system integrates three modern AI components:Image classification (diagnosis)Medical report generation (radiology-style text)Content-based image retrieval (similar case search)The objective is not only to train a neural network, but to demonstrate how multiple AI technologies can be combined into a functional medical decision-support prototype.The system was developed using the PneumoniaMNIST dataset (MedMNIST v2) and implemented entirely in Python using PyTorch and HuggingFace models.2. System CapabilitiesGiven a chest X-ray image, the system can:Detect whether pneumonia is suspectedVisualize important regions using Explainable AI (Grad-CAM)Generate an automatic medical report using a visual-language modelRetrieve visually similar X-ray cases from the datasetThis mimics a simplified real-world clinical workflow.3. DatasetDataset: PneumoniaMNIST (MedMNIST v2)Binary classification: Normal vs PneumoniaTraining images: ~4,700Validation images: ~500Test images: ~600Image size: 28×28 grayscaleInstall automatically:Bashpip install medmnist
Official website: https://medmnist.com4. Model Architecture (Task 1 – Classification)We used a Vision Transformer (ViT) as the primary classifier.PreprocessingCLAHE contrast enhancementNormalizationData augmentation (rotation, flip)Training ConfigurationEpochs: 5Optimizer: AdamLoss Function: Cross-Entropy LossFramework: PyTorchEvaluation MetricsAccuracyPrecisionRecallF1-ScoreConfusion MatrixROC CurvePerformanceMetricValueAccuracy86.38%Precision82.24%Recall99.74%F1-Score90.15%5. Explainable AI (Grad-CAM)To improve interpretability, Grad-CAM heatmaps were generated to highlight regions influencing model predictions.The model mainly focused on lung opacity regions in pneumonia cases, indicating clinically meaningful behavior.6. Medical Report Generation (Task 2 – VLM)A visual-language model (LLaVA / Med-style prompting) was used to automatically produce a radiology-style report.The model receives:X-ray imageClinical promptAnd outputs a natural language medical description including suspicion of pneumonia.Sample prompt:"You are a radiologist. Analyze this chest X-ray and write a concise medical report. State if pneumonia is suspected."7. Semantic Image Retrieval (Task 3 – CBIR)A content-based image retrieval system is implemented using image embeddings and vector similarity search (FAISS).Capabilities:Image-to-Image searchRetrieval of most similar casesVisualization of top-k matchesThis simulates a clinical “similar cases” reference system.8. Repository StructurePlaintextmedical-ai-pneumonia-diagnosis-system/
│
├── models/                     # Saved trained model
├── notebooks/                  # Colab demo notebook
├── task1_classification/       # Training and evaluation
├── task2_report_generation/    # Medical report generation
├── task3_retrieval/            # Similar image retrieval
├── reports/                    # Written reports
├── images/                     # Visual results
└── requirements.txt
9. How to Run the Project1. Clone repositoryBashgit clone https://github.com/YOUR_USERNAME/medical-ai-pneumonia-diagnosis-system.git
cd medical-ai-pneumonia-diagnosis-system
2. Install dependenciesBashpip install -r requirements.txt
3. Run demo notebookOpen:notebooks/End_to_End_Demo.ipynbor run directly in Google Colab.10. Research ObjectivesThis project demonstrates:Integration of Deep Learning + Multimodal AIExplainable AI in medical imagingAutomated medical report generationRetrieval-based clinical decision support11. AuthorDr. Motea Alsamawi Researcher in Medical AI & Biomedical Engineering12. NotesThis repository was developed as part of a Postdoctoral Technical Challenge at Alfaisal University (MedX Research Unit).Disclaimer: The code is intended for research and educational purposes only and not for clinical diagnosis.



